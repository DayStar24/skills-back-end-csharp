<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>EntityFrameworkCore Setup :: Unit 3: Back-End C# Skill Track</title>

        <link rel="stylesheet" href="http://education.launchcode.org/skills-back-end-csharp/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://education.launchcode.org/skills-back-end-csharp/css/highlight.launchcode.css">
        <link rel="stylesheet" href="http://education.launchcode.org/skills-back-end-csharp/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body id='page-entityframeworkcore-setup'>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class="active lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/classes/">
                                        Classes
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/studios/">
                                        Studios
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/assignments/">
                                        Assignments
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/videos/">
                                        Videos
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/csharp4python/">
                                        C# for Python Programmers
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/glossary/">
                                        Glossary
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/issues/">
                                        Reporting Issues
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/skills-back-end-csharp/about/">
                                        About this Unit
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>

            <div>
                <a class="navbar-brand site-title navbar-center" href="http://education.launchcode.org/skills-back-end-csharp/">
                    <h1>Unit 3: Back-End C# Skill Track</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="http://education.launchcode.org/skills-back-end-csharp/"></a>
            </div>

        </header>

        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search Unit 3: Back-End C# Skill Track</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "014657181352409571810:-32orsjtyl4";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-2 col-sm-8">
                                        <h1>EntityFrameworkCore Setup</h1>
                    <p>This article will show you how to enable the EntityFrameworkCore object-relational mapping framework. It assumes you are you are using <strong>Visual Studio 2015 v14 update 3</strong>.</p>
<aside class="aside-warning">
<p>If you try to follow along with a newer version of Visual Studio, then the package versions listed here will most likely not work for you. Additionally, you'll have problems with starter code for assignments.</p>
</aside>
<p>These instructions will enable EntityFrameworkCore (EF Core) for a given ASP.NET Core MVC project. You will need to follow these steps for every project you want to use EF Core with. At the bottom of this article we introduce an easier way to enable EF Core for new projects.</p>
<p>For the purpose of illustration, all examples will assume you're working with the <code>CheeseMVC</code> project. If you use these instructions with another project, change project names accordingly.</p>
<h2 id="setting-up-entityframeworkcore-with-an-existing-app">Setting Up EntityFrameworkCore With an Existing App</h2>
<ul>
<li>Open the NuGet Package Manager by right-clicking on the project name in the Solution Explorer and selecting <em>Manage NuGet Packages</em>.
<img src="images/manage-nuget-packages.png" alt="Manage NuGet Packages" />
<aside class="aside-warning">
<p>You might be tempted carry out the updates listed in the package manager. Resist this temptation!</p>
</aside></li>
<li>
<p>In the <em>Browse</em> tab of the package manager, search for <code>Microsoft.EntityFrameworkCore.SqlServer</code>. Click on the matching package and select <strong>Version 1.0.1</strong> from the pane at right.</p>
<img src="images/sqlserver-version.png" alt="SQLServer version" style="width:500px;"/>
<p>Then hit <em>Install</em>. You'll be asked to accept the license agreement for the package, and then you'll see some console output.</p>
</li>
<li>Check the <em>Include prerelease</em> box right of the search box. Then search for <code>Microsoft.EntityFrameworkCore.Tools</code>. Select the matching result and install <strong>Version 1.0.0-preview2-final</strong>.
<aside class="aside-warning">
<p>One of the results of this search will be <code>Microsoft.EntityFrameworkCore.Tools.DotNet</code>. This is <em>not</em> the same package as <code>Microsoft.EntityFrameworkCore.Tools</code>. Be sure to install the correct version.</p>
</aside></li>
<li>In the Solution Explorer, open <code>appsettings.json</code>
<img alt="appsettings.json" src="images/appsettings-json.png" style="width:500px;" />
<p>Add the following setting within the outer curly-braces.</p>
<pre><code class="language-json">"ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=CheeseMVC;Trusted_Connection=True;MultipleActiveResultSets=true"
  },</code></pre>
<p>The full <code>appsettings.json</code> file will look like this:</p>
<pre><code class="language-json">{
  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=CheeseMVC;Trusted_Connection=True;MultipleActiveResultSets=true"
  },
  "Logging": {
    "IncludeScopes": false,
    "LogLevel": {
      "Default": "Debug",
      "System": "Information",
      "Microsoft": "Information"
    }
  }
}</code></pre>
<p>This sets up a connection string for a local database, <a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" target="_blank">SQL Server Express LocalDB</a>. This is a lightweight database that is useful for development. You would never use this database for an active public application (aka a &quot;production application&quot;).</p></li>
<li>
<p>Open <code>project.json</code>:</p>
<img alt="project.json" src="images/project-json.png" style="width:500px;" />
<p>In the <code>tools</code> section, add:</p>
<pre><code class="language-json">"Microsoft.EntityFrameworkCore.Tools": "1.0.0-preview2-final"</code></pre>
<p>The full <code>tools</code> section should look like this:</p>
<pre><code class="language-json">"tools": {
    "BundlerMinifier.Core": "2.0.238",
    "Microsoft.AspNetCore.Razor.Tools": "1.0.0-preview2-final",
    "Microsoft.AspNetCore.Server.IISIntegration.Tools": "1.0.0-preview2-final",
    "Microsoft.EntityFrameworkCore.Tools": "1.0.0-preview2-final"
  },</code></pre>
<p>This enables some command-line tools that we'll use to update databases after making changes to our model classes.</p>
</li>
</ul>
<h2 id="setting-up-entityframeworkcore-with-a-new-app">Setting Up EntityFrameworkCore With a New App</h2>
<p>You can create a brand new project with the above packages and settings already in place by enabling individual user accounts in the New Project dialog.</p>
<p>When creating a new ASP.NET Core MVC app, select <em>Change Authentication</em> in the project template screen.</p>
<p><img src="images/change-authentication.png" alt="Change Authentication" /></p>
<p>In the modal that opens, select <em>Individual User Accounts</em>.</p>
<p><img src="images/individual-user-accounts.png" alt="Individual User Accounts" /></p>
<p>Aside from enabling a local database and EntityFrameworkCore, this also (as you might expect) enables basic user account functionality. We'll look at how to use this functionality in a future lesson.</p>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/skills-back-end-csharp/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/skills-back-end-csharp/js/highlight.pack.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/skills-back-end-csharp/js/libgif.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', "UA-78748330-6", 'auto');
            ga('send', 'pageview');

        </script>

    </body>
</html>
